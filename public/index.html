<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>WebRTC (STUN Only)</title>

	<!-- update the version number as needed -->
	<script defer src="firebase/firebase-app.js"></script>
	<!-- include only the Firebase features as you need -->
	<script defer src="firebase/firebase-firestore.js"></script>
	<!-- initialize the SDK after all desired features are loaded -->
	<script defer src="firebase/init.js"></script>

	<link rel="stylesheet" type="text/css" href="main.css">
</head>

<body>
	<h1>WebRTC (STUN Only)</h1>
	<div id="buttons">
		<button id="createBtn">Create Call ID</button>
		<button id="joinBtn">Join The Call</button>
		<button disabled id="hangupBtn">Hangup</button>
		<button onclick="window.location.reload(true)">Reload</button>
	</div>
	<div id="created-id" style="display: none;">
		You're the caller. Call ID: <input id="createdCallId" type="text" readonly onfocus="this.select()" />
	</div>
	<div id="videos">
		<video id="localVideo" autoplay playsinline></video>
		<video id="remoteVideo" autoplay playsinline></video>
		<audio id="ringtone" loop preload="auto" src="assets/incoming-call.mp3"></audio>
		<button id="ans" style="display:none; width: 60%; position: fixed; bottom: 50px; left: 20%;">Answer</button>
	</div>
	<div class="log-panel">
		LOG
		<pre id="log"></pre>
	</div>

	<script type=module>
		var logPanel = document.getElementById('log');
		window.log = function(...params) {
			logPanel.innerHTML += '\n\n' + params.map(x => JSON.stringify(x)).join(' \\\\ ');
			console.log.apply(console, params);
		}

		function createScript(fileName) {
			let script = document.createElement('script');
			script.src = `${fileName}?v=${new Date().getTime()}`
			script.type = 'module';
			document.body.appendChild(script);
		}

		// createScript('callIdCreatorPeer.js');
		// createScript('callIdUserPeer.js');
		// createScript('helper.js');
		createScript('app.js');

	</script>
</body>

</html>
